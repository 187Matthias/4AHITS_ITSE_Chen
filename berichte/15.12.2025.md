# 4AHITS ITSE Vulnerability Scanning

---

Name: Xu Matthias Chen   
Klasse: 4AHITS   
Fach: ITSE   
Datum: 15.12.2025   

---

### Übung (Optionen)
Analysiere die Bedeutung der folgenden Optionen:

```
$  nmap -Pn -sS -sV -sC -oN nmap_default.txt 10.10.92.153 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:05 EST
Stats: 0:02:34 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 75.00% done; ETC: 06:08 (0:00:50 remaining)
Stats: 0:02:59 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 87.50% done; ETC: 06:08 (0:00:25 remaining)
Nmap scan report for 10.10.92.153
Host is up.
All 1000 scanned ports on 10.10.92.153 are in ignored states.
Not shown: 1000 filtered tcp ports (no-response)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 210.10 seconds

$ cat nmap_default.txt  
# Nmap 7.94SVN scan initiated Mon Dec 15 06:05:32 2025 as: /usr/lib/nmap/nmap --privileged -Pn -sS -sV -sC -oN nmap_default.txt 10.10.92.153
Nmap scan report for 10.10.92.153
Host is up.
All 1000 scanned ports on 10.10.92.153 are in ignored states.
Not shown: 1000 filtered tcp ports (no-response)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Mon Dec 15 06:09:02 2025 -- 1 IP address (1 host up) scanned in 210.10 seconds
                                                                                                
```

Was führt nmap in diesem Fall für einen Scan aus? Wie viele Ports werden gescannt. Scanne mit diesem Befehl die metasploitable VM

-Pn: 
Deaktiviert den Host-Discovery-Ping

-sS:
Erkennt offene Ports

-sV:
Service- und Versions­erkennung

-sC:
Führt Default NSE-Skripte aus

-oN nmap_default.txt: 
Speichert die Ausgabe im normalen Textformat

Und es scant 1000 Ports.

### Übung (vulnerability scan)
nmap verfügt über eine Erweiterung über die Lua Scripts ausgeführt werden können. Die installierten Lua Scripts befinden sich im Directory /usr/share/nmap/scripts.

Aufgabe 1: Verwende die Option -sC um die Standard-Skripte auszuführen, zusätzlich beschränkt auf die 100 häufigsten Ports (Option -F) aus.

Anmerkung: nmap kann wertvolle Hinweise auf Schwachstellen liefern, ein vollwertiger vulnerability scaner ist es allerdings nicht, dafür gibt es eigene darauf spezialisierte Tools (z.B.: gvm … Greenbone Vulnerability Manager).

```
nmap -sC -F 192.168.20.52
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:21 EST
Stats: 0:00:22 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 96.04% done; ETC: 06:21 (0:00:01 remaining)
Stats: 0:00:33 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 96.23% done; ETC: 06:21 (0:00:01 remaining)
Nmap scan report for 192.168.20.52
Host is up (0.0015s latency).
Not shown: 82 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.20.51
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
22/tcp   open  ssh
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
23/tcp   open  telnet
25/tcp   open  smtp
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|     SSL2_DES_64_CBC_WITH_MD5
|     SSL2_DES_192_EDE3_CBC_WITH_MD5
|     SSL2_RC4_128_WITH_MD5
|     SSL2_RC2_128_CBC_WITH_MD5
|_    SSL2_RC4_128_EXPORT40_WITH_MD5
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
|_ssl-date: 2025-12-15T11:21:16+00:00; -1s from scanner time.
53/tcp   open  domain
| dns-nsid: 
|_  bind.version: 9.4.2
80/tcp   open  http
|_http-title: Metasploitable2 - Linux
111/tcp  open  rpcbind
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      33571/udp   mountd
|   100005  1,2,3      45461/tcp   mountd
|   100021  1,3,4      33580/tcp   nlockmgr
|   100021  1,3,4      36187/udp   nlockmgr
|   100024  1          41701/udp   status
|_  100024  1          56559/tcp   status
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
513/tcp  open  login
514/tcp  open  shell
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 7
|   Capabilities flags: 43564
|   Some Capabilities: Support41Auth, Speaks41ProtocolNew, ConnectWithDatabase, SupportsTransactions, LongColumnFlag, SupportsCompression, SwitchToSSLAfterHandshake
|   Status: Autocommit
|_  Salt: Zenz:N\da<E&-M{E(7z&
5432/tcp open  postgresql
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
|_ssl-date: 2025-12-15T11:22:01+00:00; -1s from scanner time.
5900/tcp open  vnc
| vnc-info: 
|   Protocol version: 3.3
|   Security types: 
|_    VNC Authentication (2)
6000/tcp open  X11
8009/tcp open  ajp13
|_ajp-methods: Failed to get a valid response for the OPTION request
MAC Address: 00:0C:29:00:14:79 (VMware)

Host script results:
|_smb2-time: Protocol negotiation failed (SMB2)
|_clock-skew: mean: 1h14m59s, deviation: 2h30m00s, median: -1s
|_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2025-12-15T06:21:13-05:00

Nmap done: 1 IP address (1 host up) scanned in 52.06 seconds
```

Aufgabe 2: verwende die Option --script um ausgewählte Skripte zu starten. Z.B. --script http-title,mysql-info,banner. Probiere ca. 5 Skripte aus. Nimm die Metasploitable VM als Ziel.

```
$ nmap --script acarsd-info 192.168.20.52
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:28 EST
Nmap scan report for 192.168.20.52
Host is up (0.0032s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:00:14:79 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.51 seconds

$ nmap --script address-info 192.168.20.52
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:28 EST
Nmap scan report for 192.168.20.52
Host is up (0.0019s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:00:14:79 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.40 seconds

$ nmap --script afp-brute 192.168.20.52
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:31 EST
Nmap scan report for 192.168.20.52
Host is up (0.0031s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:00:14:79 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.42 seconds

$ nmap --script afp-ls 192.168.20.52 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:31 EST
Nmap scan report for 192.168.20.52
Host is up (0.00079s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:00:14:79 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.45 seconds

$ nmap --script afp-path-vuln 192.168.20.52
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:32 EST
Nmap scan report for 192.168.20.52
Host is up (0.0031s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:00:14:79 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.55 seconds


```


Aufgabe 3: finde ein weiteres Skript das bei der Metasploitable VM sinnvolle Ergebnisse liefert

```
$ nmap --script http-methods 192.168.20.52
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:33 EST
Nmap scan report for 192.168.20.52
Host is up (0.0023s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
MAC Address: 00:0C:29:00:14:79 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.61 seconds
```

http-methods prüft HTTP-Server, welche HTTP-Verben erlaubt sind

Aufgabe 4: Die nmap Skripte sind in Kategorien eingeteilt, es gibt z.B. eine Kategorie vuln (Siehe Kategorie vuln). Verwende die Option --script=vuln um alle Skripte dieser Kategorie zu starten. Verwende als Ziel die Metasploitable VM. Dieser Scan dauert sehr lange, schränke ein auf die Ports von FTP und HTTP.

```
$ nmap --script=vuln -p 21,80 192.168.20.52
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:40 EST
Stats: 0:00:32 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 98.03% done; ETC: 06:40 (0:00:00 remaining)
Stats: 0:01:03 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 98.52% done; ETC: 06:41 (0:00:01 remaining)
Stats: 0:01:47 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 98.52% done; ETC: 06:41 (0:00:01 remaining)
Stats: 0:02:56 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 98.52% done; ETC: 06:43 (0:00:02 remaining)
Stats: 0:03:17 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 98.52% done; ETC: 06:43 (0:00:03 remaining)
Stats: 0:03:52 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 98.52% done; ETC: 06:44 (0:00:03 remaining)
Stats: 0:04:42 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 98.52% done; ETC: 06:44 (0:00:04 remaining)
Nmap scan report for 192.168.20.52
Host is up (0.00064s latency).

PORT   STATE SERVICE
21/tcp open  ftp
| ftp-vsftpd-backdoor: 
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  BID:48539  CVE:CVE-2011-2523
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure date: 2011-07-03
|     Exploit results:
|       Shell command: id
|       Results: uid=0(root) gid=0(root)
|     References:
|       https://www.securityfocus.com/bid/48539
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
|       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
|_      http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
80/tcp open  http
| http-sql-injection: 
|   Possible sqli for queries:
|     http://192.168.20.52:80/dav/?C=N%3BO%3DD%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=M%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=text-file-viewer.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=installation.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=site-footer-xss-discussion.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=register.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=framing.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=browser-info.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/?page=show-log.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?do=toggle-security%27%20OR%20sqlspider&page=home.php
|     http://192.168.20.52:80/mutillidae/?page=view-someones-blog.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/?page=user-info.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=php-errors.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=user-poll.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=captured-data.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/?page=source-viewer.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=user-info.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=capture-data.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=login.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=home.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/?page=add-to-your-blog.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=html5-storage.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=change-log.htm%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?do=toggle-hints%27%20OR%20sqlspider&page=home.php
|     http://192.168.20.52:80/mutillidae/?page=text-file-viewer.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=notes.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?username=anonymous&page=password-generator.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=show-log.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=documentation%2Fhow-to-access-Mutillidae-over-Virtual-Box-network.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=usage-instructions.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/?page=credits.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=secret-administrative-pages.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=arbitrary-file-inclusion.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=source-viewer.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/?page=login.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=set-background-color.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=view-someones-blog.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=add-to-your-blog.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=credits.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=documentation%2Fvulnerabilities.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=dns-lookup.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/mutillidae/index.php?page=pen-test-tool-lookup.php%27%20OR%20sqlspider
|     http://192.168.20.52:80/rdiff/TWiki/TWikiHistory?rev1=1.8%27%20OR%20sqlspider&rev2=1.7
|     http://192.168.20.52:80/rdiff/TWiki/TWikiHistory?rev1=1.8&rev2=1.7%27%20OR%20sqlspider
|     http://192.168.20.52:80/view/TWiki/TWikiHistory?rev=1.8%27%20OR%20sqlspider
|     http://192.168.20.52:80/rdiff/TWiki/TWikiHistory?rev1=1.9%27%20OR%20sqlspider&rev2=1.8
|     http://192.168.20.52:80/rdiff/TWiki/TWikiHistory?rev1=1.9&rev2=1.8%27%20OR%20sqlspider
|     http://192.168.20.52:80/rdiff/TWiki/TWikiHistory?rev1=1.10%27%20OR%20sqlspider&rev2=1.9
|     http://192.168.20.52:80/rdiff/TWiki/TWikiHistory?rev1=1.10&rev2=1.9%27%20OR%20sqlspider
|     http://192.168.20.52:80/view/TWiki/TWikiHistory?rev=1.9%27%20OR%20sqlspider
|     http://192.168.20.52:80/view/TWiki/TWikiHistory?rev=1.7%27%20OR%20sqlspider
|     http://192.168.20.52:80/oops/TWiki/TWikiHistory?template=oopsrev%27%20OR%20sqlspider&param1=1.10
|     http://192.168.20.52:80/oops/TWiki/TWikiHistory?template=oopsrev&param1=1.10%27%20OR%20sqlspider
|     http://192.168.20.52:80/rdiff/TWiki/TWikiHistory?rev1=1.8%27%20OR%20sqlspider&rev2=1.7
|     http://192.168.20.52:80/rdiff/TWiki/TWikiHistory?rev1=1.8&rev2=1.7%27%20OR%20sqlspider
|     http://192.168.20.52:80/view/TWiki/TWikiHistory?rev=1.8%27%20OR%20sqlspider
|     http://192.168.20.52:80/rdiff/TWiki/TWikiHistory?rev1=1.9%27%20OR%20sqlspider&rev2=1.8
|     http://192.168.20.52:80/rdiff/TWiki/TWikiHistory?rev1=1.9&rev2=1.8%27%20OR%20sqlspider
|     http://192.168.20.52:80/rdiff/TWiki/TWikiHistory?rev1=1.10%27%20OR%20sqlspider&rev2=1.9
|     http://192.168.20.52:80/rdiff/TWiki/TWikiHistory?rev1=1.10&rev2=1.9%27%20OR%20sqlspider
|     http://192.168.20.52:80/view/TWiki/TWikiHistory?rev=1.7%27%20OR%20sqlspider
|     http://192.168.20.52:80/oops/TWiki/TWikiHistory?template=oopsrev%27%20OR%20sqlspider&param1=1.10
|     http://192.168.20.52:80/oops/TWiki/TWikiHistory?template=oopsrev&param1=1.10%27%20OR%20sqlspider
|     http://192.168.20.52:80/view/TWiki/TWikiHistory?rev=1.9%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=N%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=M%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=D%3BO%3DD%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=N%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=M%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=N%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=M%3BO%3DD%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=N%3BO%3DA%27%20OR%20sqlspider
|     http://192.168.20.52:80/dav/?C=M%3BO%3DA%27%20OR%20sqlspider
|_    http://192.168.20.52:80/dav/?C=S%3BO%3DD%27%20OR%20sqlspider
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
| http-fileupload-exploiter: 
|   
|_    Couldn't find a file-type field.
|_http-trace: TRACE is enabled
|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)
| http-slowloris-check: 
|   VULNERABLE:
|   Slowloris DOS attack
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2007-6750
|       Slowloris tries to keep many connections to the target web server open and hold
|       them open as long as possible.  It accomplishes this by opening connections to
|       the target web server and sending a partial request. By doing so, it starves
|       the http server's resources causing Denial Of Service.
|       
|     Disclosure date: 2009-09-17
|     References:
|       http://ha.ckers.org/slowloris/
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750
|_http-dombased-xss: Couldn't find any DOM based XSS.
| http-csrf: 
| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.20.52
|   Found the following possible CSRF vulnerabilities: 
|     
|     Path: http://192.168.20.52:80/dvwa/
|     Form id: 
|     Form action: login.php
|     
|     Path: http://192.168.20.52:80/twiki/TWikiDocumentation.html
|     Form id: 
|     Form action: http://TWiki.org/cgi-bin/passwd/TWiki/WebHome
|     
|     Path: http://192.168.20.52:80/twiki/TWikiDocumentation.html
|     Form id: 
|     Form action: http://TWiki.org/cgi-bin/passwd/Main/WebHome
|     
|     Path: http://192.168.20.52:80/twiki/TWikiDocumentation.html
|     Form id: 
|     Form action: http://TWiki.org/cgi-bin/edit/TWiki/
|     
|     Path: http://192.168.20.52:80/twiki/TWikiDocumentation.html
|     Form id: 
|     Form action: http://TWiki.org/cgi-bin/view/TWiki/TWikiSkins
|     
|     Path: http://192.168.20.52:80/twiki/TWikiDocumentation.html
|     Form id: 
|_    Form action: http://TWiki.org/cgi-bin/manage/TWiki/ManagingWebs
| http-enum: 
|   /tikiwiki/: Tikiwiki
|   /test/: Test page
|   /phpinfo.php: Possible information file
|   /phpMyAdmin/: phpMyAdmin
|   /doc/: Potentially interesting directory w/ listing on 'apache/2.2.8 (ubuntu) dav/2'
|   /icons/: Potentially interesting folder w/ directory listing
|_  /index/: Potentially interesting folder
MAC Address: 00:0C:29:00:14:79 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 321.93 seconds

```

Übung (very safe FTP backdoor)
Der vuln-scan auf Metasploitable Port 21/FTP liefert Hinweis auf eine Schwachstelle, verwende die angezeigte CVE Nummer um genaueres über diese herauszufinden.

```
$ nmap --script=vuln -p 21 192.168.20.52 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:48 EST
Nmap scan report for 192.168.20.52
Host is up (0.0021s latency).

PORT   STATE SERVICE
21/tcp open  ftp
| ftp-vsftpd-backdoor: 
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  BID:48539  CVE:CVE-2011-2523
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure date: 2011-07-03
|     Exploit results:
|       Shell command: id
|       Results: uid=0(root) gid=0(root)
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
|       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
|       https://www.securityfocus.com/bid/48539
|_      http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
MAC Address: 00:0C:29:00:14:79 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 11.85 seconds

```

CVE-2011-2523:

Betroffene Software:

- vsftpd 2.3.4

- Offizielle Download-Version von 2011 war kompromittiert

Art der Schwachstelle

- Hardcoded Backdoor

- Kein Konfigurationsfehler

- Kein klassischer Buffer Overflow

- Manipulierte Software-Version


# 4AHITS ITSE Login Vulnerabilites 

### Übung (rlogin vulnerability)
Informiere dich über rlogin und mögliche Angriffe/Fehlkonfiguration in diesem Zusammenhang.

- Prüfe mit nmap ob der rlogin zugeordnete Port bei Metasploitable offen ist.
- Nutze diese Sicherheitslücke aus um dich als root mit rlogin einzuloggen.
- Welche Fehlkonfiguration ermöglicht diesen exploit?
- Ändere die Konfiguration von Metasploitable ab um die Sicherheitslücke zu schließen.