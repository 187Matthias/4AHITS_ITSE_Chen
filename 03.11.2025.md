# 4AHITS ITSE Port probing und scanning

---

Name: Xu Matthias Chen   
Klasse: 4AHITS   
Fach: ITSE   
Datum: 03.11.2025   

---

## √úbung (port probing)
Beim port probing m√∂chte man herausfinden ob auf einem gewissen port ein Dienst l√§uft, welcher Dienst dies ist und (wenn m√∂glich) mehr Details wie z.B. Versionsnummern. Diese Information dient als Basis f√ºr weitere Angriffe.

telnet, nc (netcat) und curl sind einfache Tools die zum port probing verwendet werden k√∂nnen. Teilweise ist es auch m√∂glich die kontaktierten Dienste dazu zu veranlassen mehr Informationen √ºber sich preiszugeben (banner grabbing).

- Verwende telnet um festzustellen ob ein ssh Server auf Metasploitable l√§uft
- Finde Bezeichnung und die Versionsnummer des Web Servers auf Metasploitable heraus. Auf 3 Arten:
 - Verwende telnet
 - Verwende nc (netcat)
  - Hinweis: der notwendige http request header kann am besten mit Hilfe eines Shell here-documents beschrieben werden.
- Verwende curl
Erstelle ein port probing cheat sheet f√ºr alle 3 Tools

### Arbeitsschritte

#### Befehl um ssh Server Status festzustellen:

```
telnet 192.168.19.52 22
```

#### Ausgabe:

```
Trying 192.168.19.52...
Connected to 192.168.19.52.
Escape character is '^]'.
SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1
```
#### Befehl um Webserver Informationen zu erhalten:

```
telnet 192.168.19.52 80
```

#### Ausgabe:

```
Trying 192.168.19.52...
Connected to 192.168.19.52.
Escape character is '^]'.
HEAD / HTTP/1.0

HTTP/1.1 200 OK
Date: Mon, 13 Oct 2025 11:43:14 GMT
Server: Apache/2.2.8 (Ubuntu) DAV/2
X-Powered-By: PHP/5.2.4-2ubuntu5.10
Connection: close
Content-Type: text/html

Connection closed by foreign host.
```

#### Ausgabe:
```
Trying 192.168.19.52...
Connected to 192.168.19.52.
Escape character is '^]'.
SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1
```

#### Befehl um Webserver Informationen zu erhalten:

```
nc 192.168.19.52 80      
```

#### Ausgabe:

```
HEAD / HHTP/1.0

HTTP/1.1 200 OK
Date: Mon, 13 Oct 2025 11:58:15 GMT
Server: Apache/2.2.8 (Ubuntu) DAV/2
X-Powered-By: PHP/5.2.4-2ubuntu5.10
Connection: close
Content-Type: text/html
```

#### Befehl um Webserver Informationen zu erhalten:

```
curl --head 192.168.19.52 80   
```

#### Ausgabe:

```
HTTP/1.1 200 OK
Date: Mon, 13 Oct 2025 12:00:12 GMT
Server: Apache/2.2.8 (Ubuntu) DAV/2
X-Powered-By: PHP/5.2.4-2ubuntu5.10
Content-Type: text/html
```

## √úbung (netcat port scan)
Ermittle mit Hilfe von netcat welche Ports zwischen 1 und 30 in der Metasploitable VM ge√∂ffnet sind ‚Äì Hinweis: dies geht in einer einzigen Kommandozeile. Recherchiere welche Dienste sich dort befinden.

Randnotitz: netcat wird auch gerne als das swiss army knife of network tools bezeichnet.

### Arbeitsschritte

#### Befehl:

```
nc -zvn -w1 192.168.19.52 1-30 
```

#### Ausgabe:

```
(UNKNOWN) [192.168.19.52] 25 (smtp) open
(UNKNOWN) [192.168.19.52] 23 (telnet) open
(UNKNOWN) [192.168.19.52] 22 (ssh) open
(UNKNOWN) [192.168.19.52] 21 (ftp) open
```

Erkl√§rung der Optionen:

- -z : Zero-I/O (nur Connect-Test, keine Daten √ºbertragen)

- -v : verbose ‚Äî zeigt ‚Äûsucceeded‚Äú / ‚Äûfailed‚Äú f√ºr jeden Port

- -n : keine DNS-Aufl√∂sung (schneller, keine Reverse-Lookups)

- -w1: Timeout 1 Sekunde (anpassbar)

- 1-30: Portbereich


## √úbung (nmap port scan)
Nach dem ping scan (und wenn nicht die Option -sn angegeben ist) f√ºhrt nmap automatisch einen port scan auf allen gefundenen hosts aus. Dabei wird versucht alle offenen Ports eines Hosts zu finden. Das Ziel ist eine Liste der am Host laufenden Dienste zu erhalten.

Hinweise: Man kann eine einzelne IP Adresse angeben, dann wird nur diese gescannt, z.B.: nmap 192.168.178.42

Siehe List of TCP and UDP port numbers

Aufgaben:

- F√ºhre einen port scan auf die Metasploitable VM durch. Analysiere das Ergebnis.

- Experimentiere mit den Optionen f√ºr (Victim ist Metasploitable VM):
 - Scannen aller m√∂glichen Ports. Macht das bei Metasploitable, verglichen zum Default Verhalten, einen Unterschied?
 - √úberspringen Ping-Scan/Host-Discovery. Warum kann diese Option notwendig sein?
 - Service/Version Detection
 - OS Erkennung
 - Aggressive Scan
 - Timing/Speed
 - Ausgabe in Dateien
 - die Option --reason
 - nur die N h√§ufigsten Ports scannen (dokumentiere den Geschwindigkeitsgewinn)
- F√ºhre weitere port scans durch, auf:
 - einem Kali Linux auf einem anderen Rechner
 - einem Windows System
 - dem Default Gateway im Labor Netz
- Was kann alles mit einem port scan herausgefunden werden? Dokumentiere!

### Arbeitsschritte

#### Scannen aller Ports:

```
$  nmap -p- 192.168.20.52 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:54 EST
Nmap scan report for 192.168.20.52
Host is up (0.0023s latency).
Not shown: 65505 closed tcp ports (reset)
PORT      STATE SERVICE
21/tcp    open  ftp
22/tcp    open  ssh
23/tcp    open  telnet
25/tcp    open  smtp
53/tcp    open  domain
80/tcp    open  http
111/tcp   open  rpcbind
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
512/tcp   open  exec
513/tcp   open  login
514/tcp   open  shell
1099/tcp  open  rmiregistry
1524/tcp  open  ingreslock
2049/tcp  open  nfs
2121/tcp  open  ccproxy-ftp
3306/tcp  open  mysql
3632/tcp  open  distccd
5432/tcp  open  postgresql
5900/tcp  open  vnc
6000/tcp  open  X11
6667/tcp  open  irc
6697/tcp  open  ircs-u
8009/tcp  open  ajp13
8180/tcp  open  unknown
8787/tcp  open  msgsrvr
33580/tcp open  unknown
45402/tcp open  unknown
45461/tcp open  unknown
56559/tcp open  unknown
MAC Address: 00:0C:29:00:14:79 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 8.36 seconds

```

- √úberspringen Ping-Scan/Host-Discovery. Warum kann diese Option notwendig sein?
 
Manche Hosts/Firewalls blockieren ICMP oder einzelne Probe-Pings ‚Üí Host w√ºrde als ‚Äûdown‚Äú erscheinen und nicht gescannt werden.

-Pn zwingt nmap, ohne Host-Discovery direkt Ports zu scannen. N√ºtzlich bei stark gefilterten Zielnetzwerken oder wenn ICMP/ARP geblockt wird.

#### Ping-Scan √ºberspringen / Host-Discovery auslassen:
```
$ nmap -Pn 192.168.20.52
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:55 EST
Nmap scan report for 192.168.20.52
Host is up (0.0041s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:00:14:79 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.34 seconds

```

#### Service / Version Detection:
```
$ sudo nmap -sV 192.168.20.52
[sudo] password for kali: 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:56 EST
Nmap scan report for 192.168.20.52
Host is up (0.0027s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
53/tcp   open  domain      ISC BIND 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
111/tcp  open  rpcbind     2 (RPC #100000)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login       OpenBSD or Solaris rlogind
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
5900/tcp open  vnc         VNC (protocol 3.3)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
MAC Address: 00:0C:29:00:14:79 (VMware)
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.84 seconds
                                                                 
```

Nutzen:

- Exakte Dienstversionen (z. B. ‚ÄûApache httpd 2.2.8‚Äú)

- Identifikation potentieller CVEs

#### OS-Erkennung:
```
$ nmap -O -sV 192.168.20.52
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:58 EST
Stats: 0:00:11 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
Service scan Timing: About 86.96% done; ETC: 06:58 (0:00:02 remaining)
Nmap scan report for 192.168.20.52
Host is up (0.00082s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
53/tcp   open  domain      ISC BIND 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
111/tcp  open  rpcbind     2 (RPC #100000)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login       OpenBSD or Solaris rlogind
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
5900/tcp open  vnc         VNC (protocol 3.3)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
MAC Address: 00:0C:29:00:14:79 (VMware)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.73 seconds

```

#### Aggressiver Scan
```
$ nmap -A 192.168.20.52
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 06:59 EST
Stats: 0:00:20 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 99.94% done; ETC: 06:59 (0:00:00 remaining)
Nmap scan report for 192.168.20.52
Host is up (0.00086s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.20.51
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_DES_64_CBC_WITH_MD5
|     SSL2_RC4_128_EXPORT40_WITH_MD5
|     SSL2_RC4_128_WITH_MD5
|     SSL2_RC2_128_CBC_WITH_MD5
|     SSL2_DES_192_EDE3_CBC_WITH_MD5
|_    SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
|_ssl-date: 2025-12-15T11:59:41+00:00; 0s from scanner time.
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
53/tcp   open  domain      ISC BIND 9.4.2
| dns-nsid: 
|_  bind.version: 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-title: Metasploitable2 - Linux
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
111/tcp  open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      33571/udp   mountd
|   100005  1,2,3      45461/tcp   mountd
|   100021  1,3,4      33580/tcp   nlockmgr
|   100021  1,3,4      36187/udp   nlockmgr
|   100024  1          41701/udp   status
|_  100024  1          56559/tcp   status
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login       OpenBSD or Solaris rlogind
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 318
|   Capabilities flags: 43564
|   Some Capabilities: Support41Auth, SupportsTransactions, Speaks41ProtocolNew, SwitchToSSLAfterHandshake, ConnectWithDatabase, LongColumnFlag, SupportsCompression
|   Status: Autocommit
|_  Salt: o2Ka&9,onYTx#?Rbs=rJ
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
|_ssl-date: 2025-12-15T11:59:41+00:00; 0s from scanner time.
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
5900/tcp open  vnc         VNC (protocol 3.3)
| vnc-info: 
|   Protocol version: 3.3
|   Security types: 
|_    VNC Authentication (2)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
| irc-info: 
|   users: 1
|   servers: 1
|   lusers: 1
|   lservers: 0
|   server: irc.Metasploitable.LAN
|   version: Unreal3.2.8.1. irc.Metasploitable.LAN 
|   uptime: 0 days, 0:46:11
|   source ident: nmap
|   source host: 6501E73A.7E0A9117.FFFA6D49.IP
|_  error: Closing Link: wwauobxkv[192.168.20.51] (Quit: wwauobxkv)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
|_ajp-methods: Failed to get a valid response for the OPTION request
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-title: Apache Tomcat/5.5
|_http-favicon: Apache Tomcat
|_http-server-header: Apache-Coyote/1.1
MAC Address: 00:0C:29:00:14:79 (VMware)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-security-mode: 
|   account_used: <blank>
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_clock-skew: mean: 1h14m59s, deviation: 2h30m00s, median: 0s
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2025-12-15T06:59:32-05:00
|_smb2-time: Protocol negotiation failed (SMB2)

TRACEROUTE
HOP RTT     ADDRESS
1   0.86 ms 192.168.20.52

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 22.11 seconds

```

Kombiniert:

- OS-Detection

- Service-Detection

- Script-Scanning

- Traceroute

#### Timing / Speed
```
$ nmap -T4 192.168.20.52
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 07:00 EST
Nmap scan report for 192.168.20.52
Host is up (0.0011s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:00:14:79 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.38 seconds
                                                               
$ nmap -T5 192.168.20.52
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 07:00 EST
Nmap scan report for 192.168.20.52
Host is up (0.00067s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:00:14:79 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.34 seconds

```

Unterschiede:

- T3 (default): zuverl√§ssig, moderat schnell

- T4: schneller, Standard f√ºr interne Labornetze

- T5: extrem schnell, aber ungenau und leicht sichtbar in IDS/IPS

#### Ausgabe in Dateien
```
nmap -oN scan.txt IP-Addresse
nmap -oX scan.xml IP-Addresse
nmap -oG scan.grepable IP-Addresse
```

- Nutzen:
Protokollierung, Weiterverarbeitung, Reporting.


#### Option --reason
```
$ nmap --reason 192.168.20.52
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 07:01 EST
Nmap scan report for 192.168.20.52
Host is up, received arp-response (0.0030s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE      REASON
21/tcp   open  ftp          syn-ack ttl 64
22/tcp   open  ssh          syn-ack ttl 64
23/tcp   open  telnet       syn-ack ttl 64
25/tcp   open  smtp         syn-ack ttl 64
53/tcp   open  domain       syn-ack ttl 64
80/tcp   open  http         syn-ack ttl 64
111/tcp  open  rpcbind      syn-ack ttl 64
139/tcp  open  netbios-ssn  syn-ack ttl 64
445/tcp  open  microsoft-ds syn-ack ttl 64
512/tcp  open  exec         syn-ack ttl 64
513/tcp  open  login        syn-ack ttl 64
514/tcp  open  shell        syn-ack ttl 64
1099/tcp open  rmiregistry  syn-ack ttl 64
1524/tcp open  ingreslock   syn-ack ttl 64
2049/tcp open  nfs          syn-ack ttl 64
2121/tcp open  ccproxy-ftp  syn-ack ttl 64
3306/tcp open  mysql        syn-ack ttl 64
5432/tcp open  postgresql   syn-ack ttl 64
5900/tcp open  vnc          syn-ack ttl 64
6000/tcp open  X11          syn-ack ttl 64
6667/tcp open  irc          syn-ack ttl 64
8009/tcp open  ajp13        syn-ack ttl 64
8180/tcp open  unknown      syn-ack ttl 64
MAC Address: 00:0C:29:00:14:79 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.31 seconds
```

Zeigt, WARUM ein Port als offen/geschlossen gilt (z. B. ‚Äûsyn-ack received‚Äú).
Hilfreich beim Lernen, Debuggen oder IDS-Analyse.

#### Nur die N h√§ufigsten Ports
```
nmap --top-ports <Zahl> IP-Addresse

$ nmap --top-ports 100 192.168.20.52
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-15 07:03 EST
Nmap scan report for 192.168.20.52
Host is up (0.0015s latency).
Not shown: 82 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
513/tcp  open  login
514/tcp  open  shell
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
8009/tcp open  ajp13
MAC Address: 00:0C:29:00:14:79 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.27 seconds
                                                                    
```

Ein Portscan kann:

- Offene Ports identifizieren

- Erkennt, welche Netzwerkdienste erreichbar sind.

- Laufende Dienste erkennen

- Beispiel:

  - FTP

  - SSH

  - HTTP


- Service-Versionen bestimmen

- Versionen verraten oft bekannte Schwachstellen.

- M√∂gliche Schwachstellen ableiten

  - z. B. veraltetes OpenSSH, verwundbare Apache-Versionen, MySQL ohne Authentifizierung.

- Firewall-Regeln analysieren

  - Welche Ports blockiert?

  - Werden Pings gefiltert?

  - Unterschied zwischen ‚Äûclosed‚Äú, ‚Äûfiltered‚Äú, ‚Äûunfiltered‚Äú.

- Netzwerkarchitektur einsch√§tzen

  - Welche Systeme existieren?

  - Welche Ger√§te exponieren Dienste?

  - Welche Rollen (Gateway, Server, Client)?

- Betriebssysteme erkennen

  - Fingerprinting √ºber Paketantworten.

#### √úbung (nmap cheat sheet)
Erstelle ein Cheat Sheet mit allen nmap Optionen die du verwendet hast und jenen die du f√ºr wichtig erachtest. Erstelle das cheat sheet so, dass es dir sp√§ter als Nachschlagewerk dienen kann.

## üîç Grundscans

```
nmap <IP>              # Standard Scan
nmap -sn <IP/Netz>      # Ping Scan
nmap -Pn <IP>           # Ohne Host-Discovery
```

## üéØ Portauswahl

```
nmap -p- <IP>           # Alle Ports
nmap -p 22,80,443 <IP>  # Spezifische Ports
nmap --top-ports 100 <IP> # H√§ufigste Ports
```

## ‚öôÔ∏è Scan-Techniken

```
nmap -sS <IP>    # SYN Scan (Standard)
nmap -sT <IP>    # Connect Scan
nmap -sU <IP>    # UDP Scan
```

## üß© Service / Version / OS

```
nmap -sV <IP>    # Version Detection
nmap -O <IP>     # OS Detection
nmap -A <IP>     # Aggressiv: OS + Version + NSE
```

## üöÄ Timing

```
-T0 (langsam)
-T3 (Default)
-T4 (schnell, LAN)
-T5 (aggressiv)
```

## üì¶ Nmap Scripting Engine

```
nmap -sC <IP>           # Default Scripts
nmap --script=vuln <IP> # Schwachstellen
```

## üíæ Ausgabe

```
nmap -oN out.txt <IP>
nmap -oX out.xml <IP>
nmap -oG out.grep <IP>
nmap -oA prefix <IP>    # Alle Formate
```

## üß† Gr√ºnde f√ºr Portstatus

```
nmap --reason <IP>
```

## üìå Beispiel: Schneller √úberblick

```
nmap -sS -sV -T4 --top-ports 100 <IP>
```
