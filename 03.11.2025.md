# 4AHITS ITSE Port probing und scanning

---

Name: Xu Matthias Chen   
Klasse: 4AHITS   
Fach: ITSE   
Datum: 03.11.2025   

---

## √úbung (port probing)
Beim port probing m√∂chte man herausfinden ob auf einem gewissen port ein Dienst l√§uft, welcher Dienst dies ist und (wenn m√∂glich) mehr Details wie z.B. Versionsnummern. Diese Information dient als Basis f√ºr weitere Angriffe.

telnet, nc (netcat) und curl sind einfache Tools die zum port probing verwendet werden k√∂nnen. Teilweise ist es auch m√∂glich die kontaktierten Dienste dazu zu veranlassen mehr Informationen √ºber sich preiszugeben (banner grabbing).

- Verwende telnet um festzustellen ob ein ssh Server auf Metasploitable l√§uft
- Finde Bezeichnung und die Versionsnummer des Web Servers auf Metasploitable heraus. Auf 3 Arten:
 - Verwende telnet
 - Verwende nc (netcat)
  - Hinweis: der notwendige http request header kann am besten mit Hilfe eines Shell here-documents beschrieben werden.
- Verwende curl
Erstelle ein port probing cheat sheet f√ºr alle 3 Tools

### Arbeitsschritte

#### Befehl um ssh Server Status festzustellen:

```
telnet 192.168.19.52 22
```

#### Ausgabe:

```
Trying 192.168.19.52...
Connected to 192.168.19.52.
Escape character is '^]'.
SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1
```
#### Befehl um Webserver Informationen zu erhalten:

```
telnet 192.168.19.52 80
```

#### Ausgabe:

```
Trying 192.168.19.52...
Connected to 192.168.19.52.
Escape character is '^]'.
HEAD / HTTP/1.0

HTTP/1.1 200 OK
Date: Mon, 13 Oct 2025 11:43:14 GMT
Server: Apache/2.2.8 (Ubuntu) DAV/2
X-Powered-By: PHP/5.2.4-2ubuntu5.10
Connection: close
Content-Type: text/html

Connection closed by foreign host.
```

#### Ausgabe:
```
Trying 192.168.19.52...
Connected to 192.168.19.52.
Escape character is '^]'.
SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1
```

#### Befehl um Webserver Informationen zu erhalten:

```
nc 192.168.19.52 80      
```

#### Ausgabe:

```
HEAD / HHTP/1.0

HTTP/1.1 200 OK
Date: Mon, 13 Oct 2025 11:58:15 GMT
Server: Apache/2.2.8 (Ubuntu) DAV/2
X-Powered-By: PHP/5.2.4-2ubuntu5.10
Connection: close
Content-Type: text/html
```

#### Befehl um Webserver Informationen zu erhalten:

```
curl --head 192.168.19.52 80   
```

#### Ausgabe:

```
HTTP/1.1 200 OK
Date: Mon, 13 Oct 2025 12:00:12 GMT
Server: Apache/2.2.8 (Ubuntu) DAV/2
X-Powered-By: PHP/5.2.4-2ubuntu5.10
Content-Type: text/html
```

## √úbung (netcat port scan)
Ermittle mit Hilfe von netcat welche Ports zwischen 1 und 30 in der Metasploitable VM ge√∂ffnet sind ‚Äì Hinweis: dies geht in einer einzigen Kommandozeile. Recherchiere welche Dienste sich dort befinden.

Randnotitz: netcat wird auch gerne als das swiss army knife of network tools bezeichnet.

### Arbeitsschritte

#### Befehl:

```
nc -zvn -w1 192.168.19.52 1-30 
```

#### Ausgabe:

```
(UNKNOWN) [192.168.19.52] 25 (smtp) open
(UNKNOWN) [192.168.19.52] 23 (telnet) open
(UNKNOWN) [192.168.19.52] 22 (ssh) open
(UNKNOWN) [192.168.19.52] 21 (ftp) open
```

Erkl√§rung der Optionen:

- -z : Zero-I/O (nur Connect-Test, keine Daten √ºbertragen)

- -v : verbose ‚Äî zeigt ‚Äûsucceeded‚Äú / ‚Äûfailed‚Äú f√ºr jeden Port

- -n : keine DNS-Aufl√∂sung (schneller, keine Reverse-Lookups)

- -w1: Timeout 1 Sekunde (anpassbar)

- 1-30: Portbereich


## √úbung (nmap port scan)
Nach dem ping scan (und wenn nicht die Option -sn angegeben ist) f√ºhrt nmap automatisch einen port scan auf allen gefundenen hosts aus. Dabei wird versucht alle offenen Ports eines Hosts zu finden. Das Ziel ist eine Liste der am Host laufenden Dienste zu erhalten.

Hinweise: Man kann eine einzelne IP Adresse angeben, dann wird nur diese gescannt, z.B.: nmap 192.168.178.42

Siehe List of TCP and UDP port numbers

Aufgaben:

- F√ºhre einen port scan auf die Metasploitable VM durch. Analysiere das Ergebnis.

- Experimentiere mit den Optionen f√ºr (Victim ist Metasploitable VM):
 - Scannen aller m√∂glichen Ports. Macht das bei Metasploitable, verglichen zum Default Verhalten, einen Unterschied?
 - √úberspringen Ping-Scan/Host-Discovery. Warum kann diese Option notwendig sein?
 - Service/Version Detection
 - OS Erkennung
 - Aggressive Scan
 - Timing/Speed
 - Ausgabe in Dateien
 - die Option --reason
 - nur die N h√§ufigsten Ports scannen (dokumentiere den Geschwindigkeitsgewinn)
- F√ºhre weitere port scans durch, auf:
 - einem Kali Linux auf einem anderen Rechner
 - einem Windows System
 - dem Default Gateway im Labor Netz
- Was kann alles mit einem port scan herausgefunden werden? Dokumentiere!

### Arbeitsschritte

#### Scannen aller Ports:

```
sudo nmap -p- IP-Addresse
```

- √úberspringen Ping-Scan/Host-Discovery. Warum kann diese Option notwendig sein?
 
Manche Hosts/Firewalls blockieren ICMP oder einzelne Probe-Pings ‚Üí Host w√ºrde als ‚Äûdown‚Äú erscheinen und nicht gescannt werden.

-Pn zwingt nmap, ohne Host-Discovery direkt Ports zu scannen. N√ºtzlich bei stark gefilterten Zielnetzwerken oder wenn ICMP/ARP geblockt wird.

#### Ping-Scan √ºberspringen / Host-Discovery auslassen:
```
nmap -Pn IP-Addresse
```

#### Service / Version Detection:
```
sudo nmap -sV IP-Addresse
```

Nutzen:

- Exakte Dienstversionen (z. B. ‚ÄûApache httpd 2.2.8‚Äú)

- Identifikation potentieller CVEs

#### OS-Erkennung:
```
nmap -O -sV IP-Addresse
```

#### Aggressiver Scan
```
nmap -A IP-Addresse
```

Kombiniert:

- OS-Detection

- Service-Detection

- Script-Scanning

- Traceroute

#### Timing / Speed
```
nmap -T4 IP-Addresse
nmap -T5 IP-Addresse
```

Unterschiede:

- T3 (default): zuverl√§ssig, moderat schnell

- T4: schneller, Standard f√ºr interne Labornetze

- T5: extrem schnell, aber ungenau und leicht sichtbar in IDS/IPS

#### Ausgabe in Dateien
```
nmap -oN scan.txt IP-Addresse
nmap -oX scan.xml IP-Addresse
nmap -oG scan.grepable IP-Addresse
```

- Nutzen:
Protokollierung, Weiterverarbeitung, Reporting.


#### Option --reason
```
nmap --reason IP-Addresse
```

Zeigt, WARUM ein Port als offen/geschlossen gilt (z. B. ‚Äûsyn-ack received‚Äú).
Hilfreich beim Lernen, Debuggen oder IDS-Analyse.

#### Nur die N h√§ufigsten Ports
```
nmap --top-ports IP-Addresse
```

Ein Portscan kann:

- Offene Ports identifizieren

- Erkennt, welche Netzwerkdienste erreichbar sind.

- Laufende Dienste erkennen

- Beispiel:

  - FTP

  - SSH

  - HTTP


- Service-Versionen bestimmen

- Versionen verraten oft bekannte Schwachstellen.

- M√∂gliche Schwachstellen ableiten

  - z. B. veraltetes OpenSSH, verwundbare Apache-Versionen, MySQL ohne Authentifizierung.

- Firewall-Regeln analysieren

  - Welche Ports blockiert?

  - Werden Pings gefiltert?

  - Unterschied zwischen ‚Äûclosed‚Äú, ‚Äûfiltered‚Äú, ‚Äûunfiltered‚Äú.

- Netzwerkarchitektur einsch√§tzen

  - Welche Systeme existieren?

  - Welche Ger√§te exponieren Dienste?

  - Welche Rollen (Gateway, Server, Client)?

- Betriebssysteme erkennen

  - Fingerprinting √ºber Paketantworten.

#### √úbung (nmap cheat sheet)
Erstelle ein Cheat Sheet mit allen nmap Optionen die du verwendet hast und jenen die du f√ºr wichtig erachtest. Erstelle das cheat sheet so, dass es dir sp√§ter als Nachschlagewerk dienen kann.

## üîç Grundscans

```
nmap <IP>              # Standard Scan
nmap -sn <IP/Netz>      # Ping Scan
nmap -Pn <IP>           # Ohne Host-Discovery
```

## üéØ Portauswahl

```
nmap -p- <IP>           # Alle Ports
nmap -p 22,80,443 <IP>  # Spezifische Ports
nmap --top-ports 100 <IP> # H√§ufigste Ports
```

## ‚öôÔ∏è Scan-Techniken

```
nmap -sS <IP>    # SYN Scan (Standard)
nmap -sT <IP>    # Connect Scan
nmap -sU <IP>    # UDP Scan
```

## üß© Service / Version / OS

```
nmap -sV <IP>    # Version Detection
nmap -O <IP>     # OS Detection
nmap -A <IP>     # Aggressiv: OS + Version + NSE
```

## üöÄ Timing

```
-T0 (langsam)
-T3 (Default)
-T4 (schnell, LAN)
-T5 (aggressiv)
```

## üì¶ Nmap Scripting Engine

```
nmap -sC <IP>           # Default Scripts
nmap --script=vuln <IP> # Schwachstellen
```

## üíæ Ausgabe

```
nmap -oN out.txt <IP>
nmap -oX out.xml <IP>
nmap -oG out.grep <IP>
nmap -oA prefix <IP>    # Alle Formate
```

## üß† Gr√ºnde f√ºr Portstatus

```
nmap --reason <IP>
```

## üìå Beispiel: Schneller √úberblick

```
nmap -sS -sV -T4 --top-ports 100 <IP>
```
